<!doctype html>
<html class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>商品分类</title>
<meta name="description" content="这是一个 index 页面">
<meta name="keywords" content="index">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="renderer" content="webkit">
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="icon" type="image/png" href="assets/i/favicon.png">
<link rel="apple-touch-icon-precomposed" href="assets/i/app-icon72x72@2x.png">
<meta name="apple-mobile-web-app-title" content="Amaze UI" />
<link rel="stylesheet" href="assets/css/amazeui.min.css"/>
<link rel="stylesheet" href="assets/css/admin.css">
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/app.js"></script>
<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
<!--<link rel="stylesheet" href="static/css/bootstrap.css" />-->
<script src="static/js/utils.js"></script>
</head>
<body>
<!--[if lte IE 9]><p class="browsehappy">升级你的浏览器吧！ <a href="http://se.360.cn/" target="_blank">升级浏览器</a>以获得更好的体验！</p><![endif]-->






</head>

<body>
<header class="am-topbar admin-header">
  <div class="am-topbar-brand"><img src="assets/i/logo.png"></div>

  <div class="am-collapse am-topbar-collapse" id="topbar-collapse">
    <ul class="am-nav am-nav-pills am-topbar-nav admin-header-list">

   <li class="am-dropdown tognzhi" data-am-dropdown>
  <button class="am-btn am-btn-primary am-dropdown-toggle am-btn-xs am-radius am-icon-bell-o" data-am-dropdown-toggle> 消息管理<span class="am-badge am-badge-danger am-round">6</span></button>
  <ul class="am-dropdown-content">
  	
  	
  	
    <li class="am-dropdown-header">所有消息都在这里</li>

    

    <li><a href="#">未激活会员 <span class="am-badge am-badge-danger am-round">556</span></a></li>
    <li><a href="#">未激活代理 <span class="am-badge am-badge-danger am-round">69</span></a></a></li>
    <li><a href="#">未处理汇款</a></li>
    <li><a href="#">未发放提现</a></li>
    <li><a href="#">未发货订单</a></li>
    <li><a href="#">低库存产品</a></li>
    <li><a href="#">信息反馈</a></li>
    
    
    
  </ul>
</li>

 <li class="kuanjie">
 	
 	<a href="#">会员管理</a>          
 	<a href="#">奖金管理</a> 
 	<a href="#">订单管理</a>   
 	<a href="#">产品管理</a> 
 	<a href="#">个人中心</a> 
 	 <a href="#">系统设置</a>
 </li>

 <li class="soso">
 	
<p>   
	
	<select data-am-selected="{btnWidth: 70, btnSize: 'sm', btnStyle: 'default'}">
          <option value="b">全部</option>
          <option value="o">产品</option>
          <option value="o">会员</option>
          
        </select>

</p>

<p class="ycfg"><input type="text" class="am-form-field am-input-sm" placeholder="圆角表单域" /></p>
<p><button class="am-btn am-btn-xs am-btn-default am-xiao"><i class="am-icon-search"></i></button></p>
 </li>




      <li class="am-hide-sm-only" style="float: right;"><a href="javascript:;" id="admin-fullscreen"><span class="am-icon-arrows-alt"></span> <span class="admin-fullText">开启全屏</span></a></li>
    </ul>
  </div>
</header>

<div class="am-cf admin-main"> 


 <div class="nav-navicon admin-main admin-sidebar">
    
    
    <div class="sideMenu am-icon-dashboard" style="color:#aeb2b7; margin: 10px 0 0 0;"> 欢迎系统管理员</div>
    <div class="sideMenu" style="font-size: 1.4rem;">
    	<h3 class="am-icon-users"><em></em> <a href="#">用户管理</a></h3>
      <ul>
         <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="用户列表.html">用户列表</a></li>
         <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="添加用户.html">添加用户</a></li>
      </ul>
      <h3 class="am-icon-flag"><em></em> <a href="#">商品管理</a></h3>
      <ul>
        <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="商品列表.html">商品列表</a></li>
        <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="添加新商品.html">添加新商品</a></li>
        <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="商品统计.html">商品统计</a></li>
      </ul>
        <h3 class="am-icon-gears on"><em></em> <a href="#">商品分类管理</a></h3>
      <ul>
        <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="商品分类.html">商品分类</a></li>
         <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="添加商品分类.html">添加商品分类</a></li>       
      </ul>    
      <h3 class="am-icon-cart-plus on"><em></em> <a href="订单列表.html"> 订单管理</a></h3>
      <ul>
         <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="订单列表.html">订单列表</a></li>
 				 <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="订单统计.html">订单统计</a></li>
      </ul>
      <h3 class="am-icon-volume-up"><em></em> <a href="#">评论管理</a></h3>
      <ul>
         <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="评论列表.html">评论列表</a></li>
 				 <li class="func" dataType='html' dataLink='msn.htm' iconImg='images/msn.gif'><a href="评论统计.html">评论统计</a></li>
      </ul>
    
    </div>
    <!-- sideMenu End --> 
    
   <script type="text/javascript">
			jQuery(".sideMenu").slide({
				titCell:"h3", //鼠标触发对象
				targetCell:"ul", //与titCell一一对应，第n个titCell控制第n个targetCell的显示隐藏
				effect:"slideDown", //targetCell下拉效果
				delayTime:300 , //效果时间
				triggerTime:150, //鼠标延迟触发时间（默认150）
				defaultPlay:true,//默认是否执行效果（默认true）
				returnDefault:true //鼠标从.sideMen移走后返回默认状态（默认false）
				});
		</script> 








</div>

</div>



<div class=" admin-content">
	
			<div class="daohang">
			<ul>
				<li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs"> 首页 </li>
				<li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs">用户管理<a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close="">×</a></button></li>
				<li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs">商品管理<a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close="">×</a></button></li>
				<li><button type="button" class="am-btn am-btn-default am-radius am-btn-xs">订单管理<a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close="">×</a></button></li>
				
				
			</ul>

       

	
</div>
	
	


<div class="admin-biaogelist">
	
    <div class="listbiaoti am-cf">
      <ul class="am-icon-flag on"> 分类列表</ul>
      
      <dl class="am-icon-home" style="float: right;"> 当前位置： 首页 > <a href="商品分类.html">分类列表</a></dl>
      
      <dl>
        
      </dl>
      
      
    </div>
	 <div id="container">

<div class="box-container-bottom" style="margin-bottom: 15px;">
<div style="background-color: white; margin-left: 12px; margin-right: 12px;">
  <el-select v-model="value" placeholder="请选择">
    <el-option
      v-for="item in options"
      :key="item.value"
      :label="item.label"
      :value="item.value">
    </el-option>
  </el-select>
    <el-button type="primary" @click="chaxun(this.value)">搜索</el-button>
</div>
	<el-table  :data="category"  border fit highlight-current-row>

					      <el-table-column
					        label="序号"
					        width="100"
					        align="center">
					        <template slot-scope="scope">
					          {{ (pageNum - 1) * limit + scope.$index + 1 }}
					        </template>
					      </el-table-column>
					      <el-table-column label="分类名称" width="300">
					        <template slot-scope="scope">
					          {{scope.row.categoryName}}
					        </template>
					      </el-table-column>					
					
					      <el-table-column label="分类级别" width="150">
					        <template slot-scope="scope">
					          {{scope.row.categoryLevel}}
					        </template>
					      </el-table-column>
					
					      <el-table-column label="口号" width="300">
					        <template slot-scope="scope">
					          {{scope.row.categorySlogan}}
					        </template>
					      </el-table-column>
					      <el-table-column label="背景颜色" width="260">
					        <template slot-scope="scope">
					          {{scope.row.categoryBgColor}}
					         
					        </template>
					      </el-table-column>
					      <el-table-column  label="操作" sortable width="210">

					      	<template slot-scope="scope">

										<el-button size="small" type="primary"  @click="bianji(scope.row)">编辑</el-button>
	<el-dialog title="修改商品分类" :visible.sync="dialogFormVisible" :append-to-body='true'>
												  <el-form :model="updateCategoryFrom" ref="updateCategoryFrom" label-width="80px" inline   size="mini" :label-position="labelPosition">
												    <el-form-item label="分类名称" prop="categoryName"  >
												      <el-input v-model="updateCategoryFrom.categoryName" autocomplete="off"></el-input>
												    </el-form-item>
													<el-form-item  prop="categoryLevel" label="分类级别"style="width: 300px;" required>
												  <el-select v-model="updateCategoryFrom.categoryLevel" placeholder="请选择">
												    <el-option
												      v-for="item in options"
												      :key="item.value"
												      :label="item.label"
												      :value="item.value">
												    </el-option>
												  </el-select>
													  </el-form-item>			

												    <el-form-item label="父级分类"  prop="parentId">
												      <el-input v-model="updateCategoryFrom.parentId" autocomplete="off"></el-input>
												    </el-form-item>
												    <el-form-item label="口号"  prop="categorySlogan" maxlength="10">
												      <el-input v-model="updateCategoryFrom.categorySlogan" autocomplete="off"></el-input>
												   </el-form-item>
												    <el-form-item label="背景颜色" prop="categoryBgColor">
												      <el-input v-model="updateCategoryFrom.categoryBgColor" autocomplete="off"></el-input>
												  
												  </el-form>
												  <div slot="footer" class="dialog-footer">

												    <el-button type="primary" @click="submitForm('updateCategoryFrom')" plain>确 定</el-button>
													    <el-button @click="dialogFormVisible = false">取 消</el-button>											    
												  </div>
												</el-dialog>


									<el-button type="danger" size="small" @click="shanchu(scope.row) " style="margin-left: 10px;">删除</el-button>
									</template>
									
									</el-table-column>

					    </el-table>
<div style="text-align: center">
							<el-pagination background layout="prev, pager, next" 
               :current-page="pageNum"
               :page-size="limit" 
               :total="count" @current-change="pager" > </el-pagination>
</div>

</div>
</div>



</div>

</div>
</div>
<!--[if lt IE 9]>
<script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="assets/js/polyfill/rem.min.js"></script>
<script src="assets/js/polyfill/respond.min.js"></script>
<script src="assets/js/amazeui.legacy.js"></script>
<![endif]--> 

<!--[if (gte IE 9)|!(IE)]><!--> 
<script src="assets/js/amazeui.min.js"></script>
<!--<![endif]-->
		<script type="text/javascript" src="static/js/cookie_utils.js" ></script>
		<script type="text/javascript" src="static/js/axios.min.js" ></script>
		<script type="text/javascript" src="static/js/vue.js" ></script>
		<!-- 引入组件库 -->
		<script src="https://unpkg.com/element-ui/lib/index.js"></script>
		<script type="text/javascript" src="static/js/base.js" ></script>
		<script type="text/javascript">
			var v = new Vue({
				el:"#container",
				data:{
					pageNum:1,
					limit:7,
					category:[],
					count:0,
					keywords:"",
					outerVisible: false,
					innerVisible: false,
					size:'',
					level:'',
					options: [{
          value: '1',
          label: '一级分类'
        }, {
          value: '2',
          label: '二级分类'
        }, {
          value: '3',
          label: '三级分类'
        },],
        value: '',
        updateCategoryFrom:{
        	categoryId:'',
        	categoryName:'',
        	categoryLevel:'',
        	parentId:'',
        	categoryIcon:'',
        	categorySlogan:'',
        	categoryPic:'',
        	categoryBgColor:'',
        },
        categoryDetail:{},
        dialogFormVisible:false,
 					labelPosition:'left',
				},
				created:function(){
					//1.加载页面，请求订单信息
					var url1 = baseUrl+"category/list-all";
					axios({
						url:url1,
						method:"get",
						params:{
							pageNum:this.pageNum,
							limit:this.limit
						}
					}).then((res)=>{
						console.log(res.data.data);
						if(res.data.code == 10000){
							var map = res.data.data
							this.category = map.list;
							this.count = map.count;
							console.log(this.category)
						}
					});
				},
				methods:{
					
					pager:function(page){

						this.pageNum = page;
						//1.加载页面，请求订单信息
						var url1 = baseUrl+"category/list-all";
						var obj = {
								pageNum:this.pageNum,
								limit:this.limit
						};
						if(this.level!=null){
							obj.level = this.level;
						}
						console.log(obj)
						axios({
							url:url1,
							method:"get",
							params:{
								pageNum:obj.pageNum,
																	limit:obj.limit,
																	level:obj.level
							}
						}).then((res)=>{
							console.log(res.data.data);
							if(res.data.code == 10000){
								this.category = res.data.data.list;
								this.count = res.data.data.count;
							}
						});
					},
					  chaxun(value){
					  	console.log(this.value)
					  	this.level=this.value;
						 	  // 控制一下，如果用户没输入东西就不去搜索
						   if(this.level != null){
						    // 把searchData带着，发请求获取有关联的数据并呈现在页面中
						    						this.pageNum = 1;
															var url1 = baseUrl+"category/list-all";
															axios({
																url:url1,
																method:"get",
																params:{
																	pageNum:this.pageNum,
																	limit:this.limit,
																	level:this.level,
																}
															}).then((res)=>{
																console.log(res.data.data);
																if(res.data.code == 10000){
																	this.category = res.data.data.list;
																	this.count = res.data.data.count;
																}
															});	
						   }
						  },
						   bianji(val){
						  			this.categoryId=val.categoryId;
										var url1 = baseUrl+"category/detail-info/"+this.categoryId;
									 axios.get(url1).then((res)=>{
									 	this.categoryDetail=res.data.data;
									 	this.categoryDetail=this.categoryDetail[0];
									 	this.updateCategoryFrom.categoryId=this.categoryDetail.categoryId;
									 this.updateCategoryFrom.categoryName=this.categoryDetail.categoryName;
									 this.updateCategoryFrom.categoryLevel=this.categoryDetail.categoryLevel;
									 this.updateCategoryFrom.parentId=this.categoryDetail.parentId;
									 this.updateCategoryFrom.categoryIcon=this.categoryDetail.categoryIcon;
									 this.updateCategoryFrom.categorySlogan=this.categoryDetail.categorySlogan;
									  this.updateCategoryFrom.categoryPic=this.categoryDetail.categoryPic;
									   this.updateCategoryFrom.categoryBgColor=this.categoryDetail.categoryBgColor;

									});		

										this.dialogFormVisible=true;
						  },
          submitForm(formName) {
					console.log(this.updateCategoryFrom)
					var newCategory = {
						  "categoryId": this.updateCategoryFrom.categoryId,
							"categoryName": this.updateCategoryFrom.categoryName,
							"categoryLevel": this.updateCategoryFrom.categoryLevel,
							"parentId": this.updateCategoryFrom.parentId,
							"categoryPic": this.updateCategoryFrom.categoryPic,
								"categoryBgColor": this.updateCategoryFrom.categoryBgColor,
								"categoryIcon": this.updateCategoryFrom.categoryIcon,
									"categorySlogan": this.updateCategoryFrom.categorySlogan,							
					};
					console.log(newCategory)
						var url5 = baseUrl+"category/update"
						axios({
							url:url5,
							method:"post",
							data:newCategory
						})
       this.$message({
          message: '修改成功',
          type: 'success'
        });
               this.dialogFormVisible = false;
               
				 setTimeout(function (){
					window.location.href="商品分类.html";
				}, 500);
 
			
            },						 
            
            					shanchu(val){
							this.$confirm('是否确认删除用户?', '提示', {
							         cancelButtonText: '取消',							         
							         confirmButtonText: '确定',
							          type: 'warning'
							        }).then(() => {
							        	this.categoryId=val.categoryId;
										var url1 = baseUrl+"category/deleteCategory/"+this.categoryId;
									 axios.get(url1).then((res)=>{
									});	
							          this.$message({
							            type: 'success',
							            message: '删除成功!'
							          });
									 setTimeout(function (){
										window.location.href="商品分类.html";
									}, 500);							          
							        }).catch(() => {
							          this.$message({
							            type: 'info',
							            message: '已取消删除'
							          });          
							        });
						  },          
				},
				
				filters: {
            time: (value) => {
            	return rTime(value);
            }
      },
      watch:{
				  // 监听input输入框，若没东西了，就回复默认状态
				  keywords:function(newnew,oldold){
				   if(newnew == ""){
				    // 发请求回到初始列表数据状态
				    console.log("搜索框没东西了，回复初始状态");
				   }
				  }
				 },
});

		</script>


</body>
</html>